基于 Dva + Razzle 的 React SSR
--------------------------------------

# 什么是 SSR

## 早期 Web 界面几乎全部都是 SSR

## React SSR 核心是使用了 renderToString... 在服务端渲染了 React APP 

# 为什么要用 SSR

## 首屏时间
## 减少接口请求时间
## SEO
## 享用 React 组件化开发

# SSR 的缺点

## SSR 本质就是连接字符串，是 CPU 密集型业务， nodejs 适合处理 I/O 密集型业务，不适合处理 CPU 密集型业务
## 增加系统复杂度

# 现有 SSR 框架分析
- nextjs，功能很全，类似 UMI 的约定式路由，开箱即用，框架屏蔽了大量复杂的细节，使开发者专注于业务逻辑。缺点，封装的太重，扩展开发比较困难，
- beidou 基于 egg.js 封装，功能很全，似乎性能很好？[] ，缺点和上边一样，封装的太重了，server 端只能用 egg.js。另外就是出于阿里，是不是基于 KPI 的开源项目？以后会不会有人维护？
- razzle 只做了简单的封装，知乎推荐。

# 为什么要用 Dva + Razzle

## 因为 Dva 开发很爽！减少了大量样板代码
## 因为 Razzle 轻便易用  

# 系统设计使命

让开发者专注于业务

- 尽量减少样板代码
- 避免在业务代码中判断运行环境

# SSR 需要处理的问题
- 4xx 和 3xx
- 透传 request header
- 异步加载组件和页面

# 遇到的问题
- TTFB 时间太长
- nodejs 常驻内存模式造成的一些问题

# 做的优化
- prefetch all chunks

# 还有的问题
- 当服务器负载过大时，自动优雅降级到 csr
  

